# 安裝和運行指南

## 系統要求
- Python 3.8 或更高版本
- 網路連接（用於安裝套件）

## 安裝步驟

### 1. 安裝依賴套件
```bash
pip install -r requirements.txt
```

### 2. 運行應用程式
```bash
streamlit run app.py
```

或者使用 Python 模組方式：
```bash
python -m streamlit run app.py
```

### 3. 存取應用程式
應用程式啟動後，在瀏覽器中開啟以下地址：
- 本機地址：http://localhost:8501
- 網路地址：http://192.168.1.114:8501（如果需要從其他設備存取）

## 使用說明

### 1. 準備資料檔案
確保您的 Excel 檔案包含以下必要欄位：
- Article (產品編號)
- Article Description (產品描述)
- RP Type (補貨類型：ND 或 RF)
- Site (店鋪編號)
- OM (營運管理單位)
- MOQ (最低派貨數量)
- SaSa Net Stock (現有庫存數量)
- Target (目標要求數量)
- Pending Received (在途訂單數量)
- Safety Stock (安全庫存數量)
- Last Month Sold Qty (上月銷量)
- MTD Sold Qty (本月至今銷量)

### 2. 上傳檔案
在應用程式介面中：
1. 點擊「瀏覽檔案」按鈕
2. 選擇您的 Excel 檔案
3. 等待系統驗證和處理資料

### 3. 選擇轉貨模式
- **A: 保守轉貨**：RF 類型轉出限制為 50%
- **B: 加強轉貨**：RF 類型轉出限制為 80%
- **C: 特強轉貨**：RF 類型轉出限制為 90% 並保留 2 件庫存

### 4. 執行分析
點擊「🚀 開始分析」按鈕生成轉貨建議

### 5. 查看結果
- KPI 指標概覽
- 轉貨建議明細表
- 統計分析表格
- 數據視覺化圖表

### 6. 匯出結果
點擊「📥 下載Excel報告」按鈕下載完整的轉貨建議報告

## 測試系統

運行測試腳本以驗證系統功能：
```bash
python test_system.py
```

## 故障排除

### 常見問題

1. **套件安裝失敗**
   - 確保 Python 版本為 3.8 或更高
   - 嘗試使用 `pip install --upgrade pip` 更新 pip
   - 如果仍有問題，嘗試使用虛擬環境

2. **檔案上傳失敗**
   - 檢查檔案格式是否為 .xlsx 或 .xls
   - 確認檔案包含所有必要欄位
   - 檢查檔案是否損壞

3. **轉貨建議為空**
   - 檢查資料中是否有 ND 類型且庫存 > 0 的記錄
   - 檢查資料中是否有 Target > 0 的記錄
   - 確認同一 OM 單位內同時有轉出和轉入候選

4. **圖表顯示異常**
   - 確保有足夠的轉貨建議數據
   - 檢查瀏覽器是否支援 JavaScript

### 技術支援
如遇到技術問題，請檢查：
1. Python 和所有套件是否正確安裝
2. 檔案格式和內容是否符合要求
3. 系統資源是否充足（記憶體、磁碟空間）

## 版本資訊
- 當前版本：v1.0
- 最後更新：2025-10-08
- 開發者：Ricky